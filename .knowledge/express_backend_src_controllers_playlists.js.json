{"is_source_file": true, "format": "JavaScript", "description": "The file defines a controller class `PlaylistsController` for handling playlist-related operations in an Express backend, including creating, fetching, updating playlists, and adding tracks. It interacts with a database via Supabase client, enforcing user-specific access controls and RLS policies.", "external_files": ["../utils/schemaInit"], "external_methods": ["ensureTablesExist"], "published": ["PlaylistsController"], "classes": [{"name": "PlaylistsController", "description": "Controller class for managing playlist operations such as creation, retrieval, update, and adding tracks, with user authentication and access control."}], "methods": [{"name": "createPlaylist(req, res)", "description": "Creates a new playlist for the authenticated user after validating input and ensuring the user's profile exists.", "scope": "PlaylistsController", "scopeKind": "class"}, {"name": "getPlaylists(req, res)", "description": "Fetches all playlists belonging to the authenticated user, relying on RLS policies for access control.", "scope": "PlaylistsController", "scopeKind": "class"}, {"name": "getPlaylistWithItems(req, res)", "description": "Retrieves details and tracks (items) of a specific playlist, including ownership validation and public/private access control.", "scope": "PlaylistsController", "scopeKind": "class"}, {"name": "updatePlaylist(req, res)", "description": "Updates playlist's description and privacy status, ensuring the owner is making changes.", "scope": "PlaylistsController", "scopeKind": "class"}, {"name": "addTrackToPlaylist(req, res)", "description": "Adds a track to a playlist, upserting track info and ensuring no duplicates; creates the track if it doesn't exist.", "scope": "PlaylistsController", "scopeKind": "class"}], "calls": ["req.supabase", "supabase.from('profiles').select(...)", "supabase.from('playlists').insert(...)", "supabase.from('playlists').select(...)", "supabase.from('playlist_items').select(...)", "supabase.from('tracks').select(...)", "supabase.from('tracks').insert(...)", "ensureTablesExist"], "search-terms": ["PlaylistsController", "createPlaylist", "getPlaylists", "getPlaylistWithItems", "updatePlaylist", "addTrackToPlaylist", "supabase", "playlist", "track", "user", "RLS policies"], "state": 2, "file_id": 17, "knowledge_revision": 90, "git_revision": "2770ea9aa55503b3f596e2fa2381a1a54439cffe", "revision_history": [{"46": "2125867a457b7715495270e8aad2b5ed263dda94"}, {"49": "2125867a457b7715495270e8aad2b5ed263dda94"}, {"69": "90d2b2940103a1a1c5566ad91ef92a28d0d63663"}, {"75": "fed757a249e0aca150247a2256948f17cf294f48"}, {"81": "79cd089895c2d20dc55487a636e1732c3b0b9d1c"}, {"84": "2770ea9aa55503b3f596e2fa2381a1a54439cffe"}, {"90": "2770ea9aa55503b3f596e2fa2381a1a54439cffe"}], "ctags": [{"_type": "tag", "name": "PlaylistsController", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^class PlaylistsController {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "addTrackToPlaylist", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^  async addTrackToPlaylist(req, res) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res)", "scope": "PlaylistsController", "scopeKind": "class"}, {"_type": "tag", "name": "audius_stream_url", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^          audius_stream_url: audius_stream_url$/", "language": "JavaScript", "kind": "property", "scope": "PlaylistsController.addTrackToPlaylist.trackInsertData", "scopeKind": "class"}, {"_type": "tag", "name": "audius_track_id", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^          audius_track_id: audius_track_id,$/", "language": "JavaScript", "kind": "property", "scope": "PlaylistsController.addTrackToPlaylist.trackInsertData", "scopeKind": "class"}, {"_type": "tag", "name": "createPlaylist", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^  async createPlaylist(req, res) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res)", "scope": "PlaylistsController", "scopeKind": "class"}, {"_type": "tag", "name": "duration_seconds", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^          duration_seconds: duration_seconds || null,$/", "language": "JavaScript", "kind": "property", "scope": "PlaylistsController.addTrackToPlaylist.trackInsertData", "scopeKind": "class"}, {"_type": "tag", "name": "exports", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^module.exports = new PlaylistsController();$/", "language": "JavaScript", "kind": "variable", "scope": "module", "scopeKind": "class"}, {"_type": "tag", "name": "getPlaylistWithItems", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^  async getPlaylistWithItems(req, res) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res)", "scope": "PlaylistsController", "scopeKind": "class"}, {"_type": "tag", "name": "getPlaylists", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^  async getPlaylists(req, res) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res)", "scope": "PlaylistsController", "scopeKind": "class"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^          title: title.trim(),$/", "language": "JavaScript", "kind": "property", "scope": "PlaylistsController.addTrackToPlaylist.trackInsertData", "scopeKind": "class"}, {"_type": "tag", "name": "trackInsertData", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^        const trackInsertData = {$/", "language": "JavaScript", "kind": "class", "scope": "PlaylistsController.addTrackToPlaylist", "scopeKind": "class"}, {"_type": "tag", "name": "updatePlaylist", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^  async updatePlaylist(req, res) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res)", "scope": "PlaylistsController", "scopeKind": "class"}], "hash": "d143394ccdc2e10fd1002118d138ed88", "format-version": 4, "code-base-name": "express_backend", "filename": "express_backend/src/controllers/playlists.js", "fields": [{"name": "audius_stream_url: audius_stream_url", "scope": "PlaylistsController.addTrackToPlaylist.trackInsertData", "scopeKind": "class", "description": "unavailable"}, {"name": "audius_track_id: audius_track_id,", "scope": "PlaylistsController.addTrackToPlaylist.trackInsertData", "scopeKind": "class", "description": "unavailable"}, {"name": "duration_seconds: duration_seconds || null,", "scope": "PlaylistsController.addTrackToPlaylist.trackInsertData", "scopeKind": "class", "description": "unavailable"}, {"name": "module.exports = new PlaylistsController();", "scope": "module", "scopeKind": "class", "description": "unavailable"}, {"name": "title: title.trim(),", "scope": "PlaylistsController.addTrackToPlaylist.trackInsertData", "scopeKind": "class", "description": "unavailable"}]}