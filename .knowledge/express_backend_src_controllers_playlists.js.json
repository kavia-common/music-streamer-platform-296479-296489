{"is_source_file": true, "format": "JavaScript", "description": "This source file defines a PlaylistsController class that manages playlist-related API endpoints in an Express.js backend, including creating playlists, fetching user playlists, and adding tracks to playlists. It handles database interactions with Supabase, enforces security via RLS, and includes input validation and error handling.", "external_files": ["../utils/schemaInit"], "external_methods": ["ensureTablesExist"], "published": ["PlaylistsController"], "classes": [{"name": "PlaylistsController", "description": "Controller class handling playlist creation, retrieval, and track addition for an authenticated user."}], "methods": [{"name": "createPlaylist(req, res)", "description": "Creates a new playlist for the authenticated user, validating input, verifying user profile existence, and handling RLS policies.", "scope": "PlaylistsController", "scopeKind": "class"}, {"name": "getPlaylists(req, res)", "description": "Fetches all playlists owned by the authenticated user, utilizing RLS to ensure access control.", "scope": "PlaylistsController", "scopeKind": "class"}, {"name": "addTrackToPlaylist(req, res)", "description": "Adds a track to an existing playlist, ensuring schema existence, ownership validation, track upsert, and proper playlist item insertion.", "scope": "PlaylistsController", "scopeKind": "class"}], "calls": ["req.supabase", "req.user.id", "supabase.from('profiles').select('user_id').eq('user_id', userId).single()", "supabase.from('playlists').insert()", "supabase.from('playlists').select()", "supabase.from('tracks').select('id').eq('audius_track_id', audius_track_id).maybeSingle()", "supabase.from('tracks').insert()", "supabase.from('playlist_items').select('position').eq('playlist_id', playlistId).order('position', { ascending: false }).limit(1).maybeSingle()", "supabase.from('playlist_items').insert()"], "search-terms": ["PlaylistsController", "createPlaylist", "getPlaylists", "addTrackToPlaylist", "Supabase", "RLS", "playlist", "track", "database schema", "express", "authorization"], "state": 2, "file_id": 17, "knowledge_revision": 69, "git_revision": "90d2b2940103a1a1c5566ad91ef92a28d0d63663", "revision_history": [{"46": "2125867a457b7715495270e8aad2b5ed263dda94"}, {"49": "2125867a457b7715495270e8aad2b5ed263dda94"}, {"69": "90d2b2940103a1a1c5566ad91ef92a28d0d63663"}], "ctags": [{"_type": "tag", "name": "PlaylistsController", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^class PlaylistsController {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "addTrackToPlaylist", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^  async addTrackToPlaylist(req, res) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res)", "scope": "PlaylistsController", "scopeKind": "class"}, {"_type": "tag", "name": "createPlaylist", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^  async createPlaylist(req, res) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res)", "scope": "PlaylistsController", "scopeKind": "class"}, {"_type": "tag", "name": "exports", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^module.exports = new PlaylistsController();$/", "language": "JavaScript", "kind": "variable", "scope": "module", "scopeKind": "class"}, {"_type": "tag", "name": "getPlaylists", "path": "/home/kavia/workspace/code-generation/music-streamer-platform-296479-296489/express_backend/src/controllers/playlists.js", "pattern": "/^  async getPlaylists(req, res) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res)", "scope": "PlaylistsController", "scopeKind": "class"}], "hash": "4541bfdb4503c7bac406acb9a22c62a6", "format-version": 4, "code-base-name": "express_backend", "filename": "express_backend/src/controllers/playlists.js", "fields": [{"name": "module.exports = new PlaylistsController();", "scope": "module", "scopeKind": "class", "description": "unavailable"}]}